<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv='content-language' content='zh-CN'>
        <title>「SwiftUI」如何使用自带的原生图表（Charts）</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="/assets/css/headerstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/blogstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />
        <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="「SwiftUI」如何使用自带的原生图表（Charts）" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="简介 在 WWDC2022 上，苹果为 SwiftUI 提供了图表相关的包Charts，这下就不用自己费劲实现图表功能了。代码量一下子从四五百行变成了十几行，甚至几行（还记得当时为了写图表功能写的快吐血了）。所以就想好好研究一下自带的图表功能，这样方便以后的开发和使用。" />
<meta property="og:description" content="简介 在 WWDC2022 上，苹果为 SwiftUI 提供了图表相关的包Charts，这下就不用自己费劲实现图表功能了。代码量一下子从四五百行变成了十几行，甚至几行（还记得当时为了写图表功能写的快吐血了）。所以就想好好研究一下自带的图表功能，这样方便以后的开发和使用。" />
<link rel="canonical" href="http://localhost:4000/blogs/cf4a629bfc06bc0f41bdb321801599c3.html" />
<meta property="og:url" content="http://localhost:4000/blogs/cf4a629bfc06bc0f41bdb321801599c3.html" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-23T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="「SwiftUI」如何使用自带的原生图表（Charts）" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-23T00:00:00+08:00","datePublished":"2022-09-23T00:00:00+08:00","description":"简介 在 WWDC2022 上，苹果为 SwiftUI 提供了图表相关的包Charts，这下就不用自己费劲实现图表功能了。代码量一下子从四五百行变成了十几行，甚至几行（还记得当时为了写图表功能写的快吐血了）。所以就想好好研究一下自带的图表功能，这样方便以后的开发和使用。","headline":"「SwiftUI」如何使用自带的原生图表（Charts）","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blogs/cf4a629bfc06bc0f41bdb321801599c3.html"},"url":"http://localhost:4000/blogs/cf4a629bfc06bc0f41bdb321801599c3.html"}</script>
<!-- End Jekyll SEO tag -->

    </head>
    <body>
        <div class="stackedit__html">
            <!-- 这个文件里是用来生成导航栏的 -->
<div class="header">
    
        <a href="/index.html" class="headerItem">
            主页
        </a>
    
        <a href="/swiftui.html" class="headerItem">
            SwiftUI
        </a>
    
        <a href="/unix.html" class="headerItem">
            UNIX
        </a>
    
        <a href="/web.html" class="headerItem">
            Web
        </a>
    
        <a href="/research.html" class="headerItem">
            Research
        </a>
    
        <a href="/book.html" class="headerItem">
            Book
        </a>
    
        <a href="/non-tech.html" class="headerItem">
            Non-Tech
        </a>
    
</div>
            <h1>「SwiftUI」如何使用自带的原生图表（Charts）</h1>
            <div class="bloginfo">
                <p class="info">2022-09-23 ｜ <a href="/swiftui.html"> SwiftUI</a> ｜ 4243 字</p>
            </div>
            <!-- excerpt-start -->
<h2 id="简介">简介</h2>
<p>在 WWDC2022 上，苹果为 SwiftUI 提供了图表相关的包<code class="language-plaintext highlighter-rouge">Charts</code>，这下就不用自己费劲实现图表功能了。代码量一下子从四五百行变成了十几行，甚至几行（还记得当时为了写图表功能写的快吐血了）。所以就想好好研究一下自带的图表功能，这样方便以后的开发和使用。</p>

<p><code class="language-plaintext highlighter-rouge">Charts</code>支持 iOS/iPadOS 16.0、macOS 13.0、Mac Catalyst 16.0、tvOS 16.0 和 watchOS 9.0 及更新的系统上使用，如果是老系统的话还是得手写。</p>

<p>包<code class="language-plaintext highlighter-rouge">Charts</code>支持六种样式的图表，但是通过组合可以实现多种图表，下面是发布会演示的图集：</p>

<p><img src="/assets/images/ef9a47a53ed944458bb07c671b916a1b.png" alt="请添加图片描述" /></p>

<p>除了这些，还有更多的样式可以实现，所以<code class="language-plaintext highlighter-rouge">Charts</code>真的需要好好研究一下。</p>

<p>但是本文主要介绍三种：条状图（BarMark）、点图（PointMark）和线图（LineMark）。下面会先介绍图表的基础使用方法，然后依次并详细介绍每种样式的使用方式（每种样式的使用方法大致相同，但是各有各的特色，比如线图可以一次显示多条线，条状图可以在一个图表中自定义显示多种颜色）。</p>

<p><img src="/assets/images/4e8a855bc7144809aabdebab02568e1f.png" alt="请添加图片描述" /></p>

<h2 id="基础使用方法">基础使用方法</h2>
<p>在开始制作图表之前，首先要准备好数据。假设我们要统计物体的形状。</p>

<p>数据如下：
| 样式 | 数量 |
|–|–|
| 立方体 | 5 |
| 球体 | 4 |
|锥体 | 4 |</p>

<p>这里的数据结构是一对一的，一个类型对应一个数量，可以说是“一维”的。</p>

<h3 id="定义数据结构和数据">定义数据结构和数据</h3>
<p>以下数据结构和数据适用于三种样式的图表，属于基础款。</p>

<p>为数据结构定义的结构体如下：</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
    <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<p>初始化的存放数据的数组如下：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">data</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"立方体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">5</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"球体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"锥体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div></div>
<h3 id="如何创建一个简单的图表">如何创建一个简单的图表</h3>
<p><strong>三种样式的基础图表使用方法几乎一样，所以这里只用讲一种即可。</strong></p>

<p>首先需要导入<code class="language-plaintext highlighter-rouge">Charts</code>包，如下：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">Charts</span>
</code></pre></div></div>
<p>然后使用方法很简单，首先创建一个<code class="language-plaintext highlighter-rouge">Chart</code>界面，作为展示数据的容器：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
	<span class="c1">//添加数据</span>
<span class="p">}</span>
</code></pre></div></div>
<p>接下来就是将数据变成点/线/条，对应的是<code class="language-plaintext highlighter-rouge">PointMark()</code>/<code class="language-plaintext highlighter-rouge">LineMark()</code>/<code class="language-plaintext highlighter-rouge">BarMark()</code>。
下面使用条状图进行演示，如果想换样式，只需要改成对应的名称，并且为了少写代码，或者方便更改，这里建议使用<code class="language-plaintext highlighter-rouge">ForEach</code>（后面会介绍如果不用<code class="language-plaintext highlighter-rouge">ForEach</code>，直接使用<code class="language-plaintext highlighter-rouge">Chart</code>也可以实现同样的效果），除了使代码简洁之外，还可以通过一些手段来进行排序（利用<code class="language-plaintext highlighter-rouge">ForEach</code>的<code class="language-plaintext highlighter-rouge">id</code>属性）：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
    <span class="kt">ForEach</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
        <span class="kt">BarMark</span><span class="p">(</span>
        	<span class="c1">//这里的x表示图表的x轴，这里的y表示图表的y轴</span>
        	<span class="c1">//需要注意的是这里的数据类型是PlottableValue</span>
            <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"形状"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
            <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"总数"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>这时候显示效果如下：</p>

<p><img src="/assets/images/27fabe7ae5834eed92fcf72e3bdcea7f.png" alt="请添加图片描述" /></p>

<p>可以看到效果不错。而且这样的话，如果想换成其他样式只要把代码中的<code class="language-plaintext highlighter-rouge">BarMark</code>更改即可，不用依次去改。</p>

<p>或者可以直接在<code class="language-plaintext highlighter-rouge">Chart</code>后面加个括号来实现同样的效果，如下：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
    <span class="kt">BarMark</span><span class="p">(</span>
        <span class="c1">//这里的x表示图表的x轴，这里的y表示图表的y轴</span>
        <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"形状"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
        <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"总数"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>如下改成线图：</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
    <span class="kt">ForEach</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
        <span class="kt">LineMark</span><span class="p">(</span>
            <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"形状"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
            <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"总数"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p><img src="/assets/images/7af1b1312eca4133be967dc90da10472.png" alt="请添加图片描述" />
点图：</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
    <span class="kt">ForEach</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
        <span class="kt">PointMark</span><span class="p">(</span>
            <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"形状"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
            <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"总数"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p><img src="/assets/images/fac2e68ce1a14ad79a70734cb16c7c87.png" alt="请添加图片描述" /></p>

<h3 id="定义二维数据结构和初始化存放数据的数组">定义“二维”数据结构和初始化存放数据的数组</h3>
<p>上一节只根据物体的形状进行了统计，那如果在加上颜色呢？</p>

<p>假设数据如下：
| 数量 | 粉色 | 黄色 | 紫色 | 绿色 | 总数 |
|–|–|–|–|–|–|
| 立方体 | 1 | 1 | 1 | 2 |5|
| 球体 | 2 | 1 | 1 | 0 | 4 |
| 锥体 | 0 | 2 | 1 | 1 | 4 |
| 总数 | 3 | 4 | 3 | 3 | 13 |</p>

<p>这样多数据结构可以说是一对二了，颜色和形状对应一个数量，可以称之为“二维”数据，比之前的“一维”难了一些。</p>

<p>那么就需要更改数据结构和存放数据的数组了，如下：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//数据结构需要多一个颜色</span>
<span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">color</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
    <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">//初始化存放数据的数组</span>
<span class="k">var</span> <span class="nv">stackedBarData</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"绿色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"立方体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"绿色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"球体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"绿色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"锥体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"紫色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"立方体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"紫色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"球体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"紫色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"锥体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"粉色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"立方体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"粉色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"球体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"粉色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"锥体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"黄色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"立方体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"黄色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"球体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"黄色"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"锥体"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div></div>

<p>下面继续先以条状图为例，这里倒不是为了省事，而是为了方便理解，后面会依次解释说明三种样式。</p>

<h3 id="如何创建一个可以显示二维数据的图表">如何创建一个可以显示“二维”数据的图表</h3>
<p>对于这种“二维”数据，需要在<code class="language-plaintext highlighter-rouge">BarMark()</code>后面加上一个<code class="language-plaintext highlighter-rouge">foregroundStyle(by:)</code>方法才可以显示，并且在图表左下方，还会显示一个图例。</p>

<p>那么来写一个图表，用于显示不同形状中，不同颜色的占比。代码如下：</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
	<span class="kt">ForEach</span><span class="p">(</span><span class="n">stackedBarData</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
		<span class="kt">BarMark</span><span class="p">(</span>
			<span class="c1">//这样写就是显示不同形状中，不同颜色的占比</span>
			<span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"形状"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
			<span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"总数"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
		<span class="p">)</span>
		<span class="c1">//这里由于颜色都可以和系统自带的对应不上，后面会介绍如何自定义颜色来进行正确的显示</span>
		<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"颜色"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">color</span><span class="p">))</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>显示效果如下：</p>

<p><img src="/assets/images/58c77b53ab6d48fd8571fc3e8a29c524.png" alt="请添加图片描述" /></p>

<p>这里就可以很直观的看到不同形状中，不同颜色的占比了。<strong>但是如果你仔细看会发现这里颜色对应的不对</strong></p>

<p>那么线图和点图是如何显示的呢?</p>

<p>线图看起来会很复杂，如下：</p>

<p><img src="/assets/images/8e12a8530e314a5bbabf5727083b8d76.png" alt="请添加图片描述" /></p>

<p>每一根线表示一种颜色，每个 X 轴区域对应一个形状。</p>

<p>点图和线图阅读方式一样，不同颜色点表示不同的颜色，每个 X 轴区域对应一个形状，但是看起来就简单不少，如下：</p>

<p><img src="/assets/images/9a3d723c968344c3bdb87db7945bfe93.png" alt="请添加图片描述" /></p>

<h3 id="自定义图表的颜色">自定义图表的颜色</h3>
<p>上一节的图表中，由于颜色都可以和系统自带的对应不上，就需要开发者手动自定义一下来显示正确的颜色。
开发者需要在<code class="language-plaintext highlighter-rouge">Chart</code>后面使用<code class="language-plaintext highlighter-rouge">chartForegroundStyleScale()</code>关键字让<code class="language-plaintext highlighter-rouge">绿色</code>、<code class="language-plaintext highlighter-rouge">紫色</code>、<code class="language-plaintext highlighter-rouge">粉色</code>和<code class="language-plaintext highlighter-rouge">黄色</code>字符串和颜色（系统自带的或者自定义的颜色）进行关联，如下：</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
	<span class="kt">ForEach</span><span class="p">(</span><span class="n">stackedBarData</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
		<span class="kt">BarMark</span><span class="p">(</span>
			<span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"形状"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
			<span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"总数"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
		<span class="p">)</span>
		<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"颜色"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">color</span><span class="p">))</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="c1">//这里将字符串和系统自带的颜色进行对应，以便显示正确的颜色</span>
<span class="o">.</span><span class="nf">chartForegroundStyleScale</span><span class="p">([</span><span class="s">"绿色"</span><span class="p">:</span> <span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="s">"紫色"</span><span class="p">:</span> <span class="o">.</span><span class="n">purple</span><span class="p">,</span> <span class="s">"粉色"</span><span class="p">:</span> <span class="o">.</span><span class="n">pink</span><span class="p">,</span> <span class="s">"黄色"</span><span class="p">:</span> <span class="o">.</span><span class="n">yellow</span><span class="p">])</span>
</code></pre></div></div>
<p>现在显示效果如下：</p>

<p><img src="/assets/images/7b6a65e5e0374678bc2f29b39a36f0b9.png" alt="请添加图片描述" /></p>

<p>可以看到颜色显示正确了。</p>

<h2 id="进阶使用方法">进阶使用方法</h2>
<p>下面就来讲述一些刚才没有讲到的使用方法。</p>

<h3 id="添加对比线rule-mark">添加对比线（Rule Mark）</h3>
<p>我不太清楚这个东西的中文名，但是一般用于对比，有时候也会用于做图，所以将其称为对比线。</p>

<p>有时候能看到在图表中有一根水平线，来表示超过某一数据，比如下图中的蓝色水平线，可以用来对比数据：
<img src="/assets/images/0da80f5940c847a8a8eb1767ff645999.png =x480" alt="请添加图片描述" />
方法很简单，就是在<code class="language-plaintext highlighter-rouge">Chart</code>的域中（就是大括号里）加上一个<code class="language-plaintext highlighter-rouge">RuleMark</code>，如下：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">RuleMark</span><span class="p">(</span><span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"对比线"</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
	<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="o">.</span><span class="n">blue</span><span class="p">)</span>
</code></pre></div></div>
<p>这里使用的是纵坐标<code class="language-plaintext highlighter-rouge">y</code>，那么可不可以使用横坐标<code class="language-plaintext highlighter-rouge">x</code>呢？答案是可以的，但是一般不使用于柱状图，而是用于线图和点图较多。因为柱状图没有使用的必要，而点图和线图中，可以用于定位点或者划分区域。</p>

<p>当然这个<code class="language-plaintext highlighter-rouge">RuleMark</code>也可以控制其起点和终点，这里继续以上图为例：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">RuleMark</span><span class="p">(</span><span class="nv">xStart</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"起点"</span><span class="p">,</span> <span class="s">"立方体"</span><span class="p">),</span> <span class="nv">xEnd</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"终点"</span><span class="p">,</span> <span class="s">"球体"</span><span class="p">),</span> <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"值"</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
	<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="o">.</span><span class="n">blue</span><span class="p">)</span>
</code></pre></div></div>
<p>增加起点和终点之后，效果如下：</p>

<p><img src="/assets/images/d4efaf2d3d3644ba82450eec6f6a11c1.png" alt="请添加图片描述" /></p>

<p>当然<code class="language-plaintext highlighter-rouge">RuleMark</code>也可以直接用于作图，如下为一个统计每个月种什么的图表：</p>

<p><img src="/assets/images/568b4d7d39584f2b912707f3ef20d009.png" alt="请添加图片描述" /></p>

<h3 id="给线图带上点">给线图带上点</h3>
<p>刚才演示的线图都是一条条折线，但是如果我们想加上点来让数据更容易理解呢？
开头提到各种样式是可以叠加的，所以可以直接加上点图来实现。</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="kd">import</span> <span class="kt">Charts</span>

<span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
    <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">data</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">5</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Pyramid"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">]</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="kt">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
                <span class="kt">LineMark</span><span class="p">(</span>
                    <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                    <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                <span class="p">)</span>
                
                <span class="c1">//加上点图来组合形成</span>
                <span class="kt">PointMark</span><span class="p">(</span>
                    <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                    <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">padding</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/4b81d3e1eeed453f836f905e477caaa6.png" alt="请添加图片描述" /></p>

<h3 id="自定义图表颜色">自定义图表颜色</h3>
<p>这个和其他组件一样，直接使用<code class="language-plaintext highlighter-rouge">Chart</code>的<code class="language-plaintext highlighter-rouge">foregroundStyle</code>属性即可，如下：</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="kd">import</span> <span class="kt">Charts</span>

<span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
    <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">data</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">5</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">),</span>
    <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Pyramid"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">]</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="kt">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
                <span class="kt">LineMark</span><span class="p">(</span>
                    <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                    <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                <span class="p">)</span>
                
                <span class="kt">PointMark</span><span class="p">(</span>
                    <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                    <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">}</span>
            <span class="c1">//这里就可以更改颜色</span>
            <span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">pink</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">padding</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>如果想修改其中的点图或者线图的颜色，在对应的<code class="language-plaintext highlighter-rouge">LineMark</code>或<code class="language-plaintext highlighter-rouge">PointMark</code>后面使用<code class="language-plaintext highlighter-rouge">foregroundStyle</code>属性即可。</p>

<p><img src="/assets/images/27400270d3734cc48577a731f4afd4a2.png" alt="请添加图片描述" /></p>

<h2 id="提醒">提醒</h2>
<p>由于图表有很多东西可以挖，所以一篇博客肯定写不完，后续还会继续写相关的博客，如果写了会在这里贴出链接。</p>

<p>如果你看完本文还有一些问题没有解决，那么请查阅官方文档<a href="https://developer.apple.com/documentation/charts">《Swift Charts》</a>，因为目前在 macOS 上，<code class="language-plaintext highlighter-rouge">Charts</code>还是 Beta 版本，所以本文的一些内容可能后面会被修改，如果您发现有不能用的地方，还请评论告知一下我哦。</p>

<p>希望能帮到有需要的人～</p>

        </div>
    </body>
</html>