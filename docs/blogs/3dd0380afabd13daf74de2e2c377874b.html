<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv='content-language' content='en'>
        <title>How to use the built-in native charts (Charts) in SwiftUI</title>
        <link rel="icon" type="image/x-icon" href="/assets/images/icon.png">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name='description' content='At WWDC2022, Apple provided the chart-related package `Charts` for SwiftUI, so you don’t have to work hard to implement the chart function yourself. The amount of code suddenly changed from four to five hundred lines to a dozen or even a few lines (I still remember that I almost vomited blood trying to write the chart function). So I want to study the built-in chart function carefully, so as to facilitate future development and use'>
        
        <link rel="stylesheet" type="text/css" href="/assets/css/headerstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/blogstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />
        
        
        <!-- Clarity tracking code for https://zhonguncle.github.io/ -->
        <script type="text/javascript">
            (function(c,l,a,r,i,t,y){
                c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
                y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
            })(window, document, "clarity", "script", "ky7zebz4nm");
        </script>
    </head>
    <body>
        <div class="stackedit__html">
            <!-- 这个文件里是用来生成导航栏的 -->
<div class="header">
    
        <a href="/index.html" class="headerItem">
            主页
        </a>
    
        <a href="/swift.html" class="headerItem">
            Swift
        </a>
    
        <a href="/unix.html" class="headerItem">
            UNIX
        </a>
    
        <a href="/c.html" class="headerItem">
            C
        </a>
    
        <a href="/assembly.html" class="headerItem">
            Assembly
        </a>
    
        <a href="/go.html" class="headerItem">
            Go
        </a>
    
        <a href="/web.html" class="headerItem">
            Web
        </a>
    
        <a href="/mcu.html" class="headerItem">
            MCU
        </a>
    
        <a href="/research.html" class="headerItem">
            Research
        </a>
    
        <a href="/non-tech.html" class="headerItem">
            Non-Tech
        </a>
    
</div>
            <h1>How to use the built-in native charts (Charts) in SwiftUI</h1>
            <div class="bloginfo">
                <p class="info">2022-09-23 ｜ <a href="/swift.html"> Swift</a> ｜ #Words: 3101 ｜ <a href="https://blog.csdn.net/qq_33919450/article/details/126964196"> 中文原版 </a></p>
            </div>
            <h2 id="introduction">Introduction</h2>
<p>At WWDC2022, Apple provided the chart-related package <code class="language-plaintext highlighter-rouge">Charts</code> for SwiftUI, so you don’t have to work hard to implement the chart function yourself. The amount of code suddenly changed from four to five hundred lines to a dozen or even a few lines (I still remember that I almost vomited blood trying to write the chart function). So I want to study the built-in chart function carefully, so as to facilitate future development and use.</p>

<p><code class="language-plaintext highlighter-rouge">Charts</code> supports iOS/iPadOS 16.0, macOS 13.0, Mac Catalyst 16.0, tvOS 16.0 and watchOS 9.0 and newer systems. If it is an old system, you still have to write it by hand.</p>

<p>The package <code class="language-plaintext highlighter-rouge">Charts</code> supports six styles of charts, but a variety of charts can be achieved through combination. The following is a gallery of images from the press conference:</p>

<p><img alt="WWDC demo gallery" src="/assets/images/ef9a47a53ed944458bb07c671b916a1b.png" style="box-shadow: 0px 0px 0px 0px" /></p>

<p>In addition to these, there are many more styles that can be implemented, so <code class="language-plaintext highlighter-rouge">Charts</code> really needs to be studied carefully.</p>

<p>But this article mainly introduces three types: bar chart (BarMark), point chart (PointMark) and line chart (LineMark). The following will first introduce the basic use of charts, and then introduce the use of each style in turn and in detail (the use of each style is roughly the same, but each has its own characteristics. For example, a line chart can display multiple lines at a time, and a bar chart can display multiple lines at a time. Charts can be customized to display multiple colors in one chart).</p>

<p><img src="/assets/images/4e8a855bc7144809aabdebab02568e1f.png" alt="Three chart styles" /></p>

<h2 id="basic-usage">Basic usage</h2>
<p>Before you start making a chart, you first need to prepare your data. Suppose we want to count the shape of an object.</p>

<p>Data are as follows:</p>

<table>
  <thead>
    <tr>
      <th>Style</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cube</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Sphere</td>
      <td>4</td>
    </tr>
    <tr>
      <td>cone</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

<p>The data structure here is one-to-one, with one type corresponding to one quantity, so it can be said to be “one-dimensional”.</p>

<h3 id="define-data-structure-and-data">Define data structure and data</h3>
<p>The following data structures and data are applicable to three styles of charts and are basic models.</p>

<p>The structure defined for the data structure is as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
     <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
     <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
     <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The initialized array to store data is as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">data</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">5</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"cone"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div></div>

<h3 id="how-to-create-a-simple-chart">How to create a simple chart</h3>
<p>**The usage methods of the three styles of basic charts are almost the same, so only one will be discussed here. **</p>

<p>First you need to import the <code class="language-plaintext highlighter-rouge">Charts</code> package, as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">importCharts</span>
</code></pre></div></div>

<p>Then the method of use is very simple. First create a <code class="language-plaintext highlighter-rouge">Chart</code> interface as a container for displaying data:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
	<span class="c1">//adding data</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The next step is to turn the data into points/lines/bars, corresponding to <code class="language-plaintext highlighter-rouge">PointMark()</code>/<code class="language-plaintext highlighter-rouge">LineMark()</code>/<code class="language-plaintext highlighter-rouge">BarMark()</code>.
The following uses a bar chart for demonstration. If you want to change the style, you only need to change it to the corresponding name. In order to write less code or facilitate changes, it is recommended to use <code class="language-plaintext highlighter-rouge">ForEach</code> (it will be introduced later that if you do not use <code class="language-plaintext highlighter-rouge">ForEach</code>, use ` directly Chart<code class="language-plaintext highlighter-rouge"> can also achieve the same effect), in addition to making the code concise, you can also sort by some means (using the </code>id<code class="language-plaintext highlighter-rouge"> attribute of </code>ForEach`):</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
     <span class="kt">ForEach</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
         <span class="kt">BarMark</span><span class="p">(</span>
         <span class="c1">//The x here represents the x-axis of the chart, and the y here represents the y-axis of the chart</span>
         <span class="c1">//It should be noted that the data type here is PlottableValue</span>
             <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"shape"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
             <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"total"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
         <span class="p">)</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>At this time, the display effect is as follows:</p>

<p><img src="/assets/images/27fabe7ae5834eed92fcf72e3bdcea7f.png" alt="Bar chart" /></p>

<p>You can see the effect is good. And in this case, if you want to change to other styles, you only need to change the <code class="language-plaintext highlighter-rouge">BarMark</code> in the code, without having to change it one by one.</p>

<p>Or you can add parentheses directly after <code class="language-plaintext highlighter-rouge">Chart</code> to achieve the same effect, as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
     <span class="kt">BarMark</span><span class="p">(</span>
         <span class="c1">//The x here represents the x-axis of the chart, and the y here represents the y-axis of the chart</span>
         <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"shape"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
         <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"total"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
     <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Change it to a line graph as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
     <span class="kt">ForEach</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
         <span class="kt">LineMark</span><span class="p">(</span>
             <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"shape"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
             <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"total"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
         <span class="p">)</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/7af1b1312eca4133be967dc90da10472.png" alt="Line diagram" /></p>

<p>Click image:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
     <span class="kt">ForEach</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
         <span class="kt">PointMark</span><span class="p">(</span>
             <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"shape"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
             <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"total"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
         <span class="p">)</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/fac2e68ce1a14ad79a70734cb16c7c87.png" alt="Click image" /></p>

<h3 id="define-the-two-dimensional-data-structure-and-initialize-the-array-to-store-the-data">Define the “two-dimensional” data structure and initialize the array to store the data</h3>
<p>The previous section only made statistics based on the shape of the object, but what if we add color?</p>

<p>Assume the data is as follows:</p>

<table>
  <thead>
    <tr>
      <th>Quantity</th>
      <th>Pink</th>
      <th>Yellow</th>
      <th>Purple</th>
      <th>Green</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cube</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <td>Sphere</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <td>Cone</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
    </tr>
    <tr>
      <td>Total</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>13</td>
    </tr>
  </tbody>
</table>

<p>Such multiple data structures can be said to be one-to-two. Color and shape correspond to a quantity, which can be called “two-dimensional” data, which is more difficult than the previous “one-dimensional” data.</p>

<p>Then you need to change the data structure and the array to store the data, as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//The data structure needs one more color</span>
<span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
     <span class="k">var</span> <span class="nv">color</span><span class="p">:</span> <span class="kt">String</span>
     <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
     <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
     <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">//Initialize the array to store data</span>
<span class="k">var</span> <span class="nv">stackedBarData</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"green"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"green"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"green"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"cone"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"Purple"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"Cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"Purple"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"Sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"purple"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"cone"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"pink"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"pink"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"pink"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"cone"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"yellow"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"yellow"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">1</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">color</span><span class="p">:</span> <span class="s">"yellow"</span><span class="p">,</span> <span class="nv">type</span><span class="p">:</span> <span class="s">"cone"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div></div>

<p>Let’s continue to take the bar chart as an example. This is not to save trouble, but to facilitate understanding. The three styles will be explained in turn later.</p>

<h3 id="how-to-create-a-chart-that-can-display-two-dimensional-data">How to create a chart that can display “two-dimensional” data</h3>
<p>For this kind of “two-dimensional” data, you need to add a <code class="language-plaintext highlighter-rouge">foregroundStyle(by:)</code> method after <code class="language-plaintext highlighter-rouge">BarMark()</code> to display it, and a legend will also be displayed at the bottom left of the chart.</p>

<p>So let’s write a chart to show the proportions of different colors in different shapes. code show as below:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
<span class="kt">ForEach</span><span class="p">(</span><span class="n">stackedBarData</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
<span class="kt">BarMark</span><span class="p">(</span>
<span class="c1">//Written like this, it shows the proportion of different colors in different shapes.</span>
<span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"shape"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
<span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"total"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1">//Since the colors here may not correspond to the ones that come with the system, we will introduce how to customize the colors for correct display later.</span>
<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"color"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">color</span><span class="p">))</span>
<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The display effect is as follows:</p>

<p><img src="/assets/images/58c77b53ab6d48fd8571fc3e8a29c524.png" alt="2D Bar Chart" /></p>

<p>Here you can intuitively see the proportions of different colors in different shapes. <strong>But if you look carefully you will find that the colors here are not corresponding</strong></p>

<p>So how are line graphs and point graphs displayed?</p>

<p>The line graph will look very complicated, as follows:</p>

<p><img src="/assets/images/8e12a8530e314a5bbabf5727083b8d76.png" alt="2D line graph" /></p>

<p>Each line represents a color, and each X-axis area corresponds to a shape.</p>

<p>Point plots are read in the same way as line plots. Different colored points represent different colors. Each X-axis area corresponds to a shape, but it looks much simpler, as follows:</p>

<p><img src="/assets/images/9a3d723c968344c3bdb87db7945bfe93.png" alt="2D dot plot" /></p>

<h3 id="customize-the-color-of-the-chart">Customize the color of the chart</h3>
<p>In the chart in the previous section, since the colors may not correspond to the ones that come with the system, developers need to manually customize them to display the correct colors.
Developers need to use the <code class="language-plaintext highlighter-rouge">chartForegroundStyleScale()</code> keyword after <code class="language-plaintext highlighter-rouge">Chart</code> to associate the <code class="language-plaintext highlighter-rouge">green</code>, <code class="language-plaintext highlighter-rouge">purple</code>, <code class="language-plaintext highlighter-rouge">pink</code> and <code class="language-plaintext highlighter-rouge">yellow</code> strings with colors (system built-in or custom colors). as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">Chart</span> <span class="p">{</span>
<span class="kt">ForEach</span><span class="p">(</span><span class="n">stackedBarData</span><span class="p">)</span> <span class="p">{</span> <span class="n">shape</span> <span class="k">in</span>
<span class="kt">BarMark</span><span class="p">(</span>
<span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"shape"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
<span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"total"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
<span class="p">)</span>
<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"color"</span><span class="p">,</span> <span class="n">shape</span><span class="o">.</span><span class="n">color</span><span class="p">))</span>
<span class="p">}</span>
<span class="p">}</span>
<span class="c1">//Here, the string is mapped to the system's own colors so that the correct colors can be displayed.</span>
<span class="o">.</span><span class="nf">chartForegroundStyleScale</span><span class="p">([</span><span class="s">"green"</span><span class="p">:</span> <span class="o">.</span><span class="n">green</span><span class="p">,</span> <span class="s">"purple"</span><span class="p">:</span> <span class="o">.</span><span class="n">purple</span><span class="p">,</span> <span class="s">"pink"</span><span class="p">:</span> <span class="o">.</span><span class="n">pink</span><span class="p">,</span> <span class="s">"yellow"</span><span class="p">:</span> <span class="o">.</span><span class="n">yellow</span><span class="p">])</span>
</code></pre></div></div>

<p>Now the display effect is as follows:</p>

<p><img src="/assets/images/7b6a65e5e0374678bc2f29b39a36f0b9.png" alt="Customize the color of the chart" /></p>

<p>You can see that the colors are displayed correctly.</p>

<h2 id="advanced-usage">Advanced usage</h2>
<p>Let’s talk about some usage methods that have not been mentioned just now.</p>

<h3 id="add-contrast-line-rule-mark">Add contrast line (Rule Mark)</h3>
<p>I don’t know the Chinese name of this thing, but it is generally used for comparison and sometimes for drawing, so it is called a contrast line.</p>

<p>Sometimes you can see a horizontal line in the chart to indicate exceeding a certain data. For example, the blue horizontal line in the picture below can be used to compare data:</p>

<p><img src="/assets/images/0da80f5940c847a8a8eb1767ff645999.png" alt="Blue horizontal line in chart" /></p>

<p>The method is very simple, just add a <code class="language-plaintext highlighter-rouge">RuleMark</code> in the field of <code class="language-plaintext highlighter-rouge">Chart</code> (that is, within the curly brackets), as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">RuleMark</span><span class="p">(</span><span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Contrast line"</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="o">.</span><span class="n">blue</span><span class="p">)</span>
</code></pre></div></div>

<p>The ordinate <code class="language-plaintext highlighter-rouge">y</code> is used here, so can the abscissa <code class="language-plaintext highlighter-rouge">x</code> be used? The answer is yes, but it is generally not used for bar charts, but more for line charts and point charts. Because there is no need to use bar graphs, but in point graphs and line graphs, they can be used to locate points or divide areas.</p>

<p>Of course, this <code class="language-plaintext highlighter-rouge">RuleMark</code> can also control its starting point and end point. Here we continue to take the above picture as an example:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">RuleMark</span><span class="p">(</span><span class="nv">xStart</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Start"</span><span class="p">,</span> <span class="s">"Cube"</span><span class="p">),</span> <span class="nv">xEnd</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"End"</span><span class="p">,</span> <span class="s">"Sphere"</span><span class="p">),</span> <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Value"</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="o">.</span><span class="n">blue</span><span class="p">)</span>
</code></pre></div></div>

<p>After adding the starting point and end point, the effect is as follows:</p>

<p><img src="/assets/images/d4efaf2d3d3644ba82450eec6f6a11c1.png" alt="Set the starting point and end point of the horizontal line" /></p>

<p>Of course, <code class="language-plaintext highlighter-rouge">RuleMark</code> can also be used directly for graphing. The following is a graph that counts what to plant each month:</p>

<p><img src="/assets/images/568b4d7d39584f2b912707f3ef20d009.png" alt="Use `RuleMark` directly to draw" /></p>

<h3 id="add-dots-to-the-line-graph">Add dots to the line graph</h3>
<p>The line graphs just demonstrated are all polylines, but what if we want to add points to make the data easier to understand?
As mentioned at the beginning, various styles can be superimposed, so you can directly add point images to achieve it.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="n">importCharts</span>

<span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
     <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
     <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
     <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">data</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">5</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Pyramid"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">]</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
     <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
         <span class="kt">VStack</span> <span class="p">{</span>
             <span class="kt">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
                 <span class="kt">LineMark</span><span class="p">(</span>
                     <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                     <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                 <span class="p">)</span>
                
                 <span class="c1">//Add point pictures to combine to form</span>
                 <span class="kt">PointMark</span><span class="p">(</span>
                     <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                     <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                 <span class="p">)</span>
             <span class="p">}</span>
         <span class="p">}</span>
         <span class="o">.</span><span class="nf">padding</span><span class="p">()</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/images/4b81d3e1eeed453f836f905e477caaa6.png" alt="Add dots to the line drawing" /></p>

<h3 id="custom-chart-color">Custom chart color</h3>
<p>This is the same as other components. You can directly use the <code class="language-plaintext highlighter-rouge">foregroundStyle</code> attribute of <code class="language-plaintext highlighter-rouge">Chart</code>, as follows:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="n">importCharts</span>

<span class="kd">struct</span> <span class="kt">ToyShape</span><span class="p">:</span> <span class="kt">Identifiable</span> <span class="p">{</span>
     <span class="k">var</span> <span class="nv">type</span><span class="p">:</span> <span class="kt">String</span>
     <span class="k">var</span> <span class="nv">count</span><span class="p">:</span> <span class="kt">Double</span>
     <span class="k">var</span> <span class="nv">id</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">data</span><span class="p">:</span> <span class="p">[</span><span class="kt">ToyShape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Cube"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">5</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Sphere"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">),</span>
     <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="s">"Pyramid"</span><span class="p">,</span> <span class="nv">count</span><span class="p">:</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">]</span>

<span class="kd">struct</span> <span class="kt">ContentView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
     <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
         <span class="kt">VStack</span> <span class="p">{</span>
             <span class="kt">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span> <span class="n">data</span> <span class="k">in</span>
                 <span class="kt">LineMark</span><span class="p">(</span>
                     <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                     <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                 <span class="p">)</span>
                
                 <span class="kt">PointMark</span><span class="p">(</span>
                     <span class="nv">x</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Shape Type"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">type</span><span class="p">),</span>
                     <span class="nv">y</span><span class="p">:</span> <span class="o">.</span><span class="nf">value</span><span class="p">(</span><span class="s">"Total Count"</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">)</span>
                 <span class="p">)</span>
             <span class="p">}</span>
             <span class="c1">//You can change the color here</span>
             <span class="o">.</span><span class="nf">foregroundStyle</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">pink</span><span class="p">)</span>
         <span class="p">}</span>
         <span class="o">.</span><span class="nf">padding</span><span class="p">()</span>
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If you want to modify the color of the point plot or line plot, use the <code class="language-plaintext highlighter-rouge">foregroundStyle</code> attribute after the corresponding <code class="language-plaintext highlighter-rouge">LineMark</code> or <code class="language-plaintext highlighter-rouge">PointMark</code>.</p>

<p><img src="/assets/images/27400270d3734cc48577a731f4afd4a2.png" alt="Customized chart color is red" /></p>

<h2 id="remind">remind</h2>
<p>Since there are a lot of things to dig out of the charts, I will certainly never finish writing one blog. I will continue to write related blogs in the future. If I do, I will post a link here.</p>

<p>If you still have some unresolved questions after reading this article, then please check the official documentation <a href="https://developer.apple.com/documentation/charts">“Swift Charts”</a>, because currently on macOS, <code class="language-plaintext highlighter-rouge">Charts</code> is still Beta version, so some of the contents of this article may be modified later. If you find something that cannot be used, please leave a comment and let me know.</p>

<p>​I hope these will help someone in need~</p>

        </div>
        <!-- comment by utterances -->
        <script src="https://utteranc.es/client.js"
        repo="ZhongUncle/zhonguncle.github.io"
        issue-term="url"
        theme="github-light"
        crossorigin="anonymous"
        async>
        </script>
        <!-- <div class="footer__html">
            <p>
                You can find me in: 
                <a href="https://blog.csdn.net/qq_33919450">CSDN</a>
                <a href="https://github.com/ZhongUncle">GitHub</a>
            </p>
        </div> -->
    </body>
</html>