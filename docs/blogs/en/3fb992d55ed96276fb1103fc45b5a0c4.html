<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv='content-language' content='en'>
        <title>SQLite 命令行使用方法</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="/assets/css/headerstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/blogstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />
        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SQLite 命令行使用方法</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="SQLite 命令行使用方法" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="最近为了省钱，就打算使用开源免费的 SQLite 来做数据库。并且由于个人习惯，所以偏爱命令行。这里就来记录一下如何使用命令行来使用 SQLite。" />
<meta property="og:description" content="最近为了省钱，就打算使用开源免费的 SQLite 来做数据库。并且由于个人习惯，所以偏爱命令行。这里就来记录一下如何使用命令行来使用 SQLite。" />
<link rel="canonical" href="http://localhost:4000/blogs/en/3fb992d55ed96276fb1103fc45b5a0c4.html" />
<meta property="og:url" content="http://localhost:4000/blogs/en/3fb992d55ed96276fb1103fc45b5a0c4.html" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-13T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SQLite 命令行使用方法" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-13T00:00:00+08:00","datePublished":"2022-02-13T00:00:00+08:00","description":"最近为了省钱，就打算使用开源免费的 SQLite 来做数据库。并且由于个人习惯，所以偏爱命令行。这里就来记录一下如何使用命令行来使用 SQLite。","headline":"SQLite 命令行使用方法","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blogs/en/3fb992d55ed96276fb1103fc45b5a0c4.html"},"url":"http://localhost:4000/blogs/en/3fb992d55ed96276fb1103fc45b5a0c4.html"}</script>
<!-- End Jekyll SEO tag -->

        
        <!-- Microsoft Clarity -->
        <script type="text/javascript">
            (function(c,l,a,r,i,t,y){
                c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
                y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
            })(window, document, "clarity", "script", "ix8xlal10a");
        </script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-SS87H0FDV7"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-SS87H0FDV7');
        </script>
    </head>
    <body>
        <div class="stackedit__html">
            <!-- 这个文件里是用来生成导航栏的 -->
<div class="header">
    
</div>
            <h1>SQLite 命令行使用方法</h1>
            <div class="bloginfo">
                <p class="info">2022-02-13 ｜ <a href="/research.html"> Research</a> ｜ 1822 字</p>
            </div>
            <!-- excerpt-start -->
<p>最近为了省钱，就打算使用开源免费的 SQLite 来做数据库。并且由于个人习惯，所以偏爱命令行。这里就来记录一下如何使用命令行来使用 SQLite。</p>

<p>安装的话，macOS 自带 sqlite3，Linux 可以使用软件包（<code class="language-plaintext highlighter-rouge">apt-get</code>或者<code class="language-plaintext highlighter-rouge">yum</code>下载）。</p>

<h2 id="sqlite-互动操作小介绍">SQLite 互动操作小介绍</h2>
<p>这里介绍一下数据库之外的一些小操作。</p>

<p>以 macOS 为例，打开“终端”之后，输入以下命令来打开一个数据库（没有的话会新建一个）：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite3 名称.db
</code></pre></div></div>

<p>这时候就会进入sqlite操作界面，如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>sqlite3 test.sql
SQLite version 3.36.0 2021-06-18 18:58:49
Enter <span class="s2">".help"</span> <span class="k">for </span>usage hints.
sqlite&gt; 
</code></pre></div></div>

<p>使用<code class="language-plaintext highlighter-rouge">.help</code>来查看<strong>点操作</strong>，例如保存成新文件，修改显示模式等，如下（有空了我会翻译一下这部分内容的）：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; .help
.auth ON|OFF             Show authorizer callbacks
.backup ?DB? FILE        Backup DB <span class="o">(</span>default <span class="s2">"main"</span><span class="o">)</span> to FILE
.bail on|off             Stop after hitting an error.  Default OFF
.binary on|off           Turn binary output on or off.  Default OFF
.cd DIRECTORY            Change the working directory to DIRECTORY
.changes on|off          Show number of rows changed by SQL
.check GLOB              Fail <span class="k">if </span>output since .testcase does not match
.clone NEWDB             Clone data into NEWDB from the existing database
.databases               List names and files of attached databases
.dbconfig ?op? ?val?     List or change sqlite3_db_config<span class="o">()</span> options
.dbinfo ?DB?             Show status information about the database
.dump ?OBJECTS?          Render database content as SQL
.echo on|off             Turn <span class="nb">command echo </span>on or off
.eqp on|off|full|...     Enable or disable automatic EXPLAIN QUERY PLAN
.excel                   Display the output of next <span class="nb">command </span><span class="k">in </span>spreadsheet
.exit ?CODE?             Exit this program with <span class="k">return</span><span class="nt">-code</span> CODE
.expert                  EXPERIMENTAL. Suggest indexes <span class="k">for </span>queries
.explain ?on|off|auto?   Change the EXPLAIN formatting mode.  Default: auto
.filectrl CMD ...        Run various sqlite3_file_control<span class="o">()</span> operations
.fullschema ?--indent?   Show schema and the content of sqlite_stat tables
.headers on|off          Turn display of headers on or off
.help ?-all? ?PATTERN?   Show <span class="nb">help </span>text <span class="k">for </span>PATTERN
.import FILE TABLE       Import data from FILE into TABLE
.imposter INDEX TABLE    Create imposter table TABLE on index INDEX
.indexes ?TABLE?         Show names of indexes
.limit ?LIMIT? ?VAL?     Display or change the value of an SQLITE_LIMIT
.lint OPTIONS            Report potential schema issues.
.log FILE|off            Turn logging on or off.  FILE can be stderr/stdout
.mode MODE ?TABLE?       Set output mode
.nullvalue STRING        Use STRING <span class="k">in </span>place of NULL values
.once ?OPTIONS? ?FILE?   Output <span class="k">for </span>the next SQL <span class="nb">command </span>only to FILE
.open ?OPTIONS? ?FILE?   Close existing database and reopen FILE
.output ?FILE?           Send output to FILE or stdout <span class="k">if </span>FILE is omitted
.parameter CMD ...       Manage SQL parameter bindings
.print STRING...         Print literal STRING
.progress N              Invoke progress handler after every N opcodes
.prompt MAIN CONTINUE    Replace the standard prompts
.quit                    Exit this program
.read FILE               Read input from FILE
.recover                 Recover as much data as possible from corrupt db.
.restore ?DB? FILE       Restore content of DB <span class="o">(</span>default <span class="s2">"main"</span><span class="o">)</span> from FILE
.save FILE               Write <span class="k">in</span><span class="nt">-memory</span> database into FILE
.scanstats on|off        Turn sqlite3_stmt_scanstatus<span class="o">()</span> metrics on or off
.schema ?PATTERN?        Show the CREATE statements matching PATTERN
.selftest ?OPTIONS?      Run tests defined <span class="k">in </span>the SELFTEST table
.separator COL ?ROW?     Change the column and row separators
.session ?NAME? CMD ...  Create or control sessions
.sha3sum ...             Compute a SHA3 <span class="nb">hash </span>of database content
.shell CMD ARGS...       Run CMD ARGS... <span class="k">in </span>a system shell
.show                    Show the current values <span class="k">for </span>various settings
.stats ?ARG?             Show stats or turn stats on or off
.system CMD ARGS...      Run CMD ARGS... <span class="k">in </span>a system shell
.tables ?TABLE?          List names of tables matching LIKE pattern TABLE
.testcase NAME           Begin redirecting output to <span class="s1">'testcase-out.txt'</span>
.testctrl CMD ...        Run various sqlite3_test_control<span class="o">()</span> operations
.timeout MS              Try opening locked tables <span class="k">for </span>MS milliseconds
.timer on|off            Turn SQL timer on or off
.trace ?OPTIONS?         Output each SQL statement as it is run
.vfsinfo ?AUX?           Information about the top-level VFS
.vfslist                 List all available VFSes
.vfsname ?AUX?           Print the name of the VFS stack
.width NUM1 NUM2 ...     Set minimum column widths <span class="k">for </span>columnar output
</code></pre></div></div>

<p>如果我们想退出 SQLite 可以输入<code class="language-plaintext highlighter-rouge">.exit</code>，或者按下<strong>Control + D</strong>来退出，情形如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; .exit
</code></pre></div></div>

<p><strong>需要注意的是：除了点操作之外，其他命令都要以分号结尾（;），不然sqlite会认为命令没有结束，而出现以下情况：</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; CREATE TABLE tbl2 <span class="o">(</span>
   ...&gt; 
</code></pre></div></div>

<p>这种情况我们可以输入分号来表示命令的结束，也可以利用这一点来输入长命令，例如下面这样：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; CREATE TABLE tbl2 <span class="o">(</span>
   ...&gt;   f1 varchar<span class="o">(</span>30<span class="o">)</span> primary key,
   ...&gt;   f2 text,
   ...&gt;   f3 real
   ...&gt; <span class="o">)</span><span class="p">;</span>
sqlite&gt;
</code></pre></div></div>

<h2 id="新建数据库中的表格">新建数据库中的表格</h2>
<p>在学会一些基础操作之后，马上就要开始了解数据库四大技能：增删改查。
不过我们得新建一个表格。这里我们新建一个 2 列的表格，第一列名为“<code class="language-plaintext highlighter-rouge">one</code>”，数据类型是<code class="language-plaintext highlighter-rouge">varchar</code>（一种字符类型），最大字符数量为 20；第二列名为“<code class="language-plaintext highlighter-rouge">two</code>”，是<code class="language-plaintext highlighter-rouge">smallint</code>（一种整数类型），输入命令如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; create table tbl1<span class="o">(</span>one varchar<span class="o">(</span>10<span class="o">)</span>, two smallint<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="增删改查">增删改查</h2>
<p>“<strong>增</strong>”在这里就是插入（insert）一条数据，方式如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; insert into tbl1 values<span class="o">(</span><span class="s1">'hello!'</span>,10<span class="o">)</span><span class="p">;</span>
sqlite&gt; insert into tbl1 values<span class="o">(</span><span class="s1">'goodbye'</span>, 20<span class="o">)</span><span class="p">;</span>
</code></pre></div></div>

<p>这里我们插入了两行数据。然后我们来查看一下（这里展示了默认情况和修改模式之后的样式）：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; <span class="k">select</span> <span class="k">*</span> from tbl1<span class="p">;</span>
hello!|10
goodbye|20
sqlite&gt; .mode column
sqlite&gt; <span class="k">select</span> <span class="k">*</span> from tbl1<span class="p">;</span>
one      two
<span class="nt">-------</span>  <span class="nt">---</span>
hello!   10 
goodbye  20 
</code></pre></div></div>

<p>“<strong>删</strong>”是删除（delte）符合某种要求的数据，通过指定该行的某一元素来删除（所以也可以删除多条数据）。例如使用以下命令来删除上面数据库中“<code class="language-plaintext highlighter-rouge">one</code>”列中元素的值为<code class="language-plaintext highlighter-rouge">hello</code>所在的行：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; delete from tbl1 
   ...&gt; where <span class="nv">one</span><span class="o">=</span><span class="s1">'hello'</span>
   ...&gt; <span class="p">;</span>
sqlite&gt; <span class="k">select</span> <span class="k">*</span> from tbl1<span class="p">;</span>
one      two
<span class="nt">-------</span>  <span class="nt">---</span>
goodbye  20 
</code></pre></div></div>

<p>然后我们插入几条数据变成下面这样来演示删除多条数据：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>one      two
<span class="nt">-------</span>  <span class="nt">---</span>
goodbye  20 
a        20 
b        20 
c        10 
c        20 
</code></pre></div></div>

<p>然后我们输入以下命令来试试看：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; delete from tbl1
   ...&gt; where <span class="nv">two</span><span class="o">=</span>20<span class="p">;</span>
sqlite&gt; <span class="k">select</span> <span class="k">*</span> from tbl1<span class="p">;</span>
one  two
<span class="nt">---</span>  <span class="nt">---</span>
c    10 
</code></pre></div></div>

<p>我们会发现<code class="language-plaintext highlighter-rouge">two</code>列的值等于 20 的行全删掉了。
<strong>当然你可能也发现了，字符串格式的值需要加单引号，整数啥的直接等于就好了。</strong></p>

<p><strong>改</strong>就是更新（update）数据呀，不过这也提醒我们要加一条数据独一无二的列，例如 id 之类的。不过这里只是展示就不加了。我们将第一列的<strong>c</strong>修改成<strong>abc</strong>，命令如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; update tbl1
   ...&gt; <span class="nb">set </span><span class="nv">one</span><span class="o">=</span><span class="s1">'abc'</span>	<span class="c">#这里是需要改成的值</span>
   ...&gt; where <span class="nv">two</span><span class="o">=</span>10<span class="p">;</span>	<span class="c">#这里是选择需要被修改的值的筛选条件</span>
sqlite&gt; <span class="k">select</span> <span class="k">*</span> from tbl1<span class="p">;</span>
one  two
<span class="nt">---</span>  <span class="nt">---</span>
abc  10 
</code></pre></div></div>

<p><strong>查</strong>就是选择（select）符合条件的数据。
例如我们在<code class="language-plaintext highlighter-rouge">tbl1</code>表格中查找<code class="language-plaintext highlighter-rouge">two</code>值小于 20 的数据，使用命令如下：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite&gt; <span class="k">select</span> <span class="k">*</span>
   ...&gt; from tbl1
   ...&gt; where two&lt;20
   ...&gt; <span class="p">;</span>
one  two
<span class="nt">---</span>  <span class="nt">---</span>
abc  10 
</code></pre></div></div>

<p>好啦，这也我们就可以简单的使用 SQLite 了。一些技巧我会慢慢写成单独的博客的。</p>

<p>希望能帮到有需要的人～</p>

        </div>
    </body>
</html>