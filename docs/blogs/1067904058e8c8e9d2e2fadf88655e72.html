<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv='content-language' content='en'>
        <title>Why GIF is static image rather than video?</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="/assets/css/headerstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/blogstyle.css" />
        <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />
        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Why GIF is static image rather than video?</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="Why GIF is static image rather than video?" />
<meta property="og:locale" content="en" />
<meta name="description" content="When I was organizing my disk, I have a question: What is GIFs classified as? Static image files or video files?" />
<meta property="og:description" content="When I was organizing my disk, I have a question: What is GIFs classified as? Static image files or video files?" />
<link rel="canonical" href="https://zhonguncle.github.io/blogs/1067904058e8c8e9d2e2fadf88655e72.html" />
<meta property="og:url" content="https://zhonguncle.github.io/blogs/1067904058e8c8e9d2e2fadf88655e72.html" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-09-20T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Why GIF is static image rather than video?" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-09-20T00:00:00+08:00","datePublished":"2023-09-20T00:00:00+08:00","description":"When I was organizing my disk, I have a question: What is GIFs classified as? Static image files or video files?","headline":"Why GIF is static image rather than video?","mainEntityOfPage":{"@type":"WebPage","@id":"https://zhonguncle.github.io/blogs/1067904058e8c8e9d2e2fadf88655e72.html"},"url":"https://zhonguncle.github.io/blogs/1067904058e8c8e9d2e2fadf88655e72.html"}</script>
<!-- End Jekyll SEO tag -->

        
        <!-- Microsoft Clarity -->
        <script type="text/javascript">
            (function(c,l,a,r,i,t,y){
                c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
                t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
                y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
            })(window, document, "clarity", "script", "ix8xlal10a");
        </script>

        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-SS87H0FDV7"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-SS87H0FDV7');
        </script>
    </head>
    <body>
        <div class="stackedit__html">
            <!-- 这个文件里是用来生成导航栏的 -->
<div class="header">
    
        <a href="/index.html" class="headerItem">
            主页
        </a>
    
        <a href="/swift.html" class="headerItem">
            Swift
        </a>
    
        <a href="/unix.html" class="headerItem">
            UNIX
        </a>
    
        <a href="/c.html" class="headerItem">
            C
        </a>
    
        <a href="/assembly.html" class="headerItem">
            Assembly
        </a>
    
        <a href="/go.html" class="headerItem">
            Go
        </a>
    
        <a href="/plan9.html" class="headerItem">
            Plan 9
        </a>
    
        <a href="/web.html" class="headerItem">
            Web
        </a>
    
        <a href="/mcu.html" class="headerItem">
            MCU
        </a>
    
        <a href="/research.html" class="headerItem">
            Research
        </a>
    
        <a href="/non-tech.html" class="headerItem">
            Non-Tech
        </a>
    
</div>
            <h1>Why GIF is static image rather than video?</h1>
            <div class="bloginfo">
                <p class="info">2023-09-20 ｜ <a href="/research.html"> Research</a> ｜ #Words: 5699 </p>
            </div>
            <!-- excerpt-start -->
<p>When I was organizing my disk, I have a question: What is GIFs classified as? Static image files or video files?</p>

<p>Because if you put it in a video, GIF is classified as a static image usually and is composed of images; if you put it in an image, it shows animations.</p>

<p>Then I have new problem: Why GIFs shows animations, but be classified as static images?</p>

<p>I read many blogs, but the answers did not deep enough for me. They like “beacuse GIF is static images, so it is static images”. So I did some research by myself and wrote this blog, hoping to help people who have the same questions as me.</p>

<p>The structure of article is “GIF file format” -&gt; “History of GIF” -&gt; “Conclusion”. Some history about technology is also placed in “The History of GIFs”.</p>

<h2 id="gif-file-format">GIF file format</h2>
<p>If want to explain the question in depth, we need to introduce the format of GIF file briefly first. And you will make sense why GIF appear in history.</p>

<p>If you want to learn more details of the GIF file format, here is a good article, which is also one of the reference materials for this article: <a href="https://www.cs.cmu.edu/~cil/lzw.and.gif.txt">“LZW and GIF explained—- Steve Blackstock” </a>.</p>

<p>A GIF file has 5 major parts:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	+-----------------------+
	| +-------------------+ |
	| |   GIF Signature   | |
	| +-------------------+ |
	| +-------------------+ |
	| | Screen Descriptor | |
	| +-------------------+ |
	| +-------------------+ |
	| | Global Color Map  | |
	| +-------------------+ |
	. . .		    . . .
	| +-------------------+ |    ---+
	| |  Image Descriptor | |	|
	| +-------------------+ |	|
	| +-------------------+ |	|
	| |  Local Color Map  | |	|-   Repeated 1 to n times
	| +-------------------+ |	|
	| +-------------------+ |	|
	| |    Raster Data    | |	|
	| +-------------------+ |    ---+
	. . .		    . . .
	| +-------------------+ |
	|-|   GIF Terminator  |-|
	| +-------------------+ |
	+-----------------------+
</code></pre></div></div>

<p>For understanding, here is a GIF for explaining:</p>

<p><img src="/assets/images/IMG_7268.GIF" alt="GIF example" /></p>

<p>You use hex viewer(like <code class="language-plaintext highlighter-rouge">hexdump</code>) to check GIF above and can get the following content:</p>

<p><img alt="GIF file in hex" src="/assets/images/28d7410e60cf402ab006905299857476.png" style="box-shadow: 0px 0px 0px 0px" /></p>

<h3 id="gif-signatureheader">GIF signature（header）</h3>
<blockquote>
  <p>On UNIX, file format is decided by header, rather than file suffix.</p>
</blockquote>

<p>The header of GIF file is GIF signature, which is 6 bytes and has two versions: “GIF87a (47h 49h 46h 38h 37h 48h)” and “GIF89a (47h 49h 46h 38h 39h 48h)”.</p>
<ol>
  <li>Screen descriptor describes the size of the image and provides some image informations, which is the 7 bytes in screenshot, I mark them as “size”, “information”, “background color”, and “indicates the end”:</li>
  <li>Image size occupies 4 bytes, which 2 bytes are length and 2 bytes are width. So the maximum length and width are 65536 (2^16). The size of example GIF is 72x72(48x48 in hex), and you can see “48” in screenshot above. <strong>Two points need to be noted in this: GIF uses big endian, <code class="language-plaintext highlighter-rouge">48 00</code> means <code class="language-plaintext highlighter-rouge">0048h</code>; secondly, offical name is “screen size”, which comes from history of graphics systems and computer. I won’t explain it, if you are interested in, you can watch “The 8-Bit Guy” videos about early computer graphics systems in Youtube.</strong></li>
  <li>Image information occupies 1 byte, but contains a lot of information, so I will use binary format to explain. In above screenshot, <code class="language-plaintext highlighter-rouge">f6</code> is written as “<code class="language-plaintext highlighter-rouge">1111 0110</code>” in binary.
    <ol>
      <li>Bit 1 is the global color mapping symbol, indicating whether use global color mapping later, here <code class="language-plaintext highlighter-rouge">1</code> means “use”;</li>
      <li>Bit 2~4 add 1 indicate the color depth. Here is <code class="language-plaintext highlighter-rouge">111</code>(mean “7” in decimal) and add 1 equal to 8, which means the color depth is 8 bits(up to 256 colors). This value will be used by color mapping;</li>
      <li>Bit 5 is reserved for the future, must be <code class="language-plaintext highlighter-rouge">0</code>;</li>
      <li>Bit 6~8 add 1 indicates the bits of each pixel in the image. Here is <code class="language-plaintext highlighter-rouge">110</code>(mean “6” in decimal). Adding 1 equals 7, it means “color size” of a single pixel in this image is 7 bits(up to 128 colors). This value is related to the image.</li>
    </ol>
  </li>
  <li>Background color is <code class="language-plaintext highlighter-rouge">00</code>, which means white.</li>
  <li><code class="language-plaintext highlighter-rouge">00</code> indicates the end.</li>
</ol>

<h3 id="global-color-map">Global Color Map</h3>
<p>In screenshot above, the area from tail of the first line to the <code class="language-plaintext highlighter-rouge">00000180</code> line is the global color mapping part. Although global color mapping is optional, modern GIFs basically enable it and are used to represent the color of each pixel.</p>

<h4 id="what-is-color-map">What is Color Map</h4>
<p>Originally I wanted to omit the explanation of color mapping, but this technology outdated, many people may not understand it. So I will explain it in detail.</p>

<p>Nowadays, many people know that the colors on the screen are mostly composed of three colors: red, green and blue (printer is CMYK). We can describe a color by values of the three colors. But why a “RGB” value can determine a color?</p>

<p>You may answer me: We extract a color from gamut by this value. That’s very close the truth.</p>

<p>Now, please imagine you are a game developer from the 1980s, you only have 8 bits to display delicate colors. 8 bits is only can represent 256 values, and you need to use three colors together, rather than black and white. This sounds impossible! Because today most custom screen have 24 bits for a pixel(each color occupies 8 bit), which is 16777216 color. This gap is too big. How 1980s game developer implement it?</p>

<p>Did you notice that I just say <strong>how many colors</strong>, and this color may not be evenly distributed. In the GIF above, the main colors are black, deep blue, red, and white, which are very simple in composition and not composed of very complex colors. So we map colors needed to values, not map any color we won’t use. Now a detailed image can be displayed. Many of the games on early game consoles such as Famicom consoles used this technology to achieve screen effects beyond specifications.</p>

<p><strong>This color map can be understood as a palette, and the color space supported by the system or monitor can be understood as a paint box. The paint may have hundreds of thousands of colors, but the palette can only hold dozens of colors.</strong> For example, when creating a GIF with a single pixel size of 8 bits in the 24-bit RGB color space, 256 colors are taken out of 16777216 paints (local color mapping is to give each image a palette).</p>

<p>Let’s back to global color mapping. Color mapping is generally arranged in the order of “black to white”. But you can also sort by frequency or other (“Image Descriptors” section for details).</p>

<p>For example, in GIF above, <code class="language-plaintext highlighter-rouge">03h 03h 03h</code> is the darkest color(hair rope):</p>

<p><img alt="For example, in GIF above, 03h 03h 03h is the darkest color that is the main color of hair rope" src="/assets/images/6106c13888b549cd9ae4ccc0b052b818.png" width="250" /></p>

<p><code class="language-plaintext highlighter-rouge">17h 17h 17h</code>is the second darkest color：</p>

<p><img alt="`17h 17h 17h`is the second darkest color" src="/assets/images/1ce546c689804ed0947cf70c7bef74bb.png" width="250" /></p>

<h4 id="how-to-calculate-the-size-of-the-global-color-map-area">How to calculate the size of the global color map area</h4>
<p>Notice: The global color mapping area of GIF files is not a fixed size. The calculation is as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(1 &lt;&lt;(([Byte of Image Information] &amp; 0x07) + 1)) * 3
</code></pre></div></div>

<p>For example, <code class="language-plaintext highlighter-rouge">f6</code> in gif above means：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(1 &lt;&lt;((0xf6 &amp; 0x07) + 1)) * 3

0xf6 &amp; 0x07 = 1111 0110b
			&amp; 0000 0111b
			————————————
			  0000 0110b = 6
			  
1 &lt;&lt;((0xf6 &amp; 0x07) + 1)) = 1 &lt;&lt; 7 = 1000 0000b = 128

(1 &lt;&lt;((0xf6 &amp; 0x07) + 1)) * 3 = 128*3=384
</code></pre></div></div>

<p>So the data block size for the global color map above is 384 bytes.
所以上面的全局颜色映射的数据块大小为 384 个字节。</p>

<h3 id="扩展块">扩展块</h3>
<p>在这个地方，可能还会有一个或多个扩展块，以<code class="language-plaintext highlighter-rouge">21h</code>开头，<code class="language-plaintext highlighter-rouge">00h</code>结尾。可以用来说明动画间隔和背景透明度等很多相关信息。
扩展块的大小是固定的，不过 87a 和 89a 的不一样大。如果是 87a，那么这部分是图形控制扩展块（8 字节）。
如果是 89a，那么会有图形控制扩展块（8 字节）、纯文本扩展块（15 字节）、应用程序扩展块（14 字节）、注释扩展块（5～256 字节） 这 4 个扩展块，每个扩展块都以<code class="language-plaintext highlighter-rouge">21h</code>开头，区分在于第二个字节：</p>
<ul>
  <li>如果是<code class="language-plaintext highlighter-rouge">f9h</code>，那么将数据块标识为图形控制扩展块；</li>
  <li>如果是<code class="language-plaintext highlighter-rouge">01h</code>，那么将数据块标识为纯文本扩展块；</li>
  <li>如果是<code class="language-plaintext highlighter-rouge">ffh</code>，那么将数据块标识为应用程序扩展块；</li>
</ul>

<p>还是以上面的图为例，截取扩展块的部分：</p>

<p><img src="/assets/images/c0c63b817af74bc087dbd5c220b2e9df.png" alt="GIF 扩展块的部分" /></p>

<p>两条红线之间的字节便是扩展块的部分。</p>

<p><strong>首先<code class="language-plaintext highlighter-rouge">21h ffh</code>说明为应用程序扩展块。</strong>
<code class="language-plaintext highlighter-rouge">0bh</code>为应用程序标识符和 Authent Code 字段中的字节数（这个值是固定的，必须是<code class="language-plaintext highlighter-rouge">0b</code>）。AuthentCode 字段包含一个值，该值用于标识创建应用程序扩展块的软件应用程序。如果识别此标识符值成功，则读取数据块的剩余部分，并对其数据进行操作。如果无法识别标识符值，则读取数据块的剩余部分并丢弃其数据。
接下来的<code class="language-plaintext highlighter-rouge">4e 45 54 53 43 41 50 45</code>（十六进制）就是应用程序标识符，根据 ASCII 可以得到“NETSCAPE”。<code class="language-plaintext highlighter-rouge">32 2e 30</code>（十六进制）则为 Authent Code，根据 ASCII 可以得到“2.0”。这后面则是取决于应用程序和开发者。最后<code class="language-plaintext highlighter-rouge">00h</code>结束块。</p>

<blockquote>
  <p>Netscape 是第一个允许用户与图像交互的浏览器，比如说创新性地可以点击图像跳转页面。可以说 Netscape 拯救了 GIF，不然当时就没了，这点也是 CompuServe 总裁在采访的时候所说的。</p>
</blockquote>

<p><strong>然后<code class="language-plaintext highlighter-rouge">21h f9h</code>表示为图形控制扩展块。</strong>
接下来的<code class="language-plaintext highlighter-rouge">04h</code>是固定的值，为 Packed、DelayTime 和ColorIndex 字段的字节数总和，也就是一共 4 个字节。<strong>（如果是 GIF87a 则只有一个<code class="language-plaintext highlighter-rouge">21h</code>）</strong>
Packed 字段有 4 个部分，上图中为<code class="language-plaintext highlighter-rouge">04h</code>，二进制为<code class="language-plaintext highlighter-rouge">0000 0100</code>。</p>
<ul>
  <li>第 1 位用来表示 ColorIndex 字段中颜色透明度字段是否有值，这里为<code class="language-plaintext highlighter-rouge">0</code>说明没有值。</li>
  <li>第 2 位是用户输入标志，如果进入下一个图像序列之前需要用户输入（按下某键或者点击鼠标），那么此处为<code class="language-plaintext highlighter-rouge">1</code>，否则为<code class="language-plaintext highlighter-rouge">0</code>。这里为<code class="language-plaintext highlighter-rouge">0</code>说明不需要用户操作即可进入下一图像。</li>
  <li>第 3～5 位表示图像显示后如何处理，（这里的数字为二进制）
    <ul>
      <li><code class="language-plaintext highlighter-rouge">000</code>（未指定处置方法）</li>
      <li><code class="language-plaintext highlighter-rouge">001</code>（不处理图形），图中是<code class="language-plaintext highlighter-rouge">001</code>，所以就没有任何操作。</li>
      <li><code class="language-plaintext highlighter-rouge">010</code>（用背景颜色覆盖图形）</li>
      <li><code class="language-plaintext highlighter-rouge">011</code>（用以前的图形覆盖图形）</li>
    </ul>
  </li>
  <li>第 6～8 位是保留的，不过 GIF89a 中不实用此子字段，所以始终为<code class="language-plaintext highlighter-rouge">0</code>。</li>
</ul>

<p>可以看到图形控制扩展块的内容可以让 GIF 变得可以像 PPT 一样。</p>

<p>接下来的 1 个字节便是 DelayTime 字段，内容为<code class="language-plaintext highlighter-rouge">0ah</code>，表示等待 0.1 秒再播放下一图像。0.1 秒也就是 1/10 秒，也就是可以理解成每秒显示 10 帧。
下面 2 个字节是颜色透明度，这里是<code class="language-plaintext highlighter-rouge">00h</code>，而且前面 Packed 字段中第一位是<code class="language-plaintext highlighter-rouge">0</code>。也就是说没有这个字段略过，也就是没有调整颜色透明度。
紧接着的<code class="language-plaintext highlighter-rouge">ffh</code>这个字节应该是<code class="language-plaintext highlighter-rouge">00h</code>，这里应该是软件自己的特色。
最后<code class="language-plaintext highlighter-rouge">00h</code>表示扩展块结束。</p>

<h3 id="图像">图像</h3>
<p>然后便是 GIF 中每一张图像的内容了。GIF 中的图像数据使用 LZW（Lempel-Ziv-Welch）算法进行压缩，由<code class="language-plaintext highlighter-rouge">2ch</code>（ASCII 对应<code class="language-plaintext highlighter-rouge">,</code>）开始，并且由三部分以下组成：</p>
<ul>
  <li>图像描述符；</li>
  <li>局部颜色映射（这个当然也是可选的了）；</li>
  <li>光栅数据。</li>
</ul>

<h4 id="图像描述符local-image-descriptor">图像描述符（Local Image Descriptor）</h4>
<p>图像描述符又被称为图像标题，以<code class="language-plaintext highlighter-rouge">2ch</code>开始，<code class="language-plaintext highlighter-rouge">07h</code>结束，也就是下图这部分：</p>

<p><img src="/assets/images/b3b5e962a4704942b8fb7feb224ad953.png" alt="图像标题，以 2ch 开始，07h 结束" /></p>

<p>这部分内容包含了图像描述符的分隔符<code class="language-plaintext highlighter-rouge">2ch</code>（一个字节），图像的坐标 X 和 Y（各两个字节）、图像的长和宽（各两个字节）、图像和颜色映射数据的信息（一个字节），以及终止符<code class="language-plaintext highlighter-rouge">07h</code>（一个字节）。
由上图可知，图像的坐标 X 和 Y 都为 <code class="language-plaintext highlighter-rouge">00h 00h</code>。图像尺寸和前文一样，长宽都是 72x72 像素。
图像和颜色映射数据的信息有 4 个子字段，这里的<code class="language-plaintext highlighter-rouge">00h</code>二进制为<code class="language-plaintext highlighter-rouge">0000 0000</code>，那么：</p>
<ul>
  <li>第 1 位为局部颜色映射标志，如果此位为<code class="language-plaintext highlighter-rouge">1</code>，则图像有个局部颜色映射，使用局部颜色映射；如果为<code class="language-plaintext highlighter-rouge">0</code>，那么使用全局颜色映射。图中这里为<code class="language-plaintext highlighter-rouge">0</code>，说明使用全局颜色映射。</li>
  <li>第 2 位为隔行生成标志，如果此处为<code class="language-plaintext highlighter-rouge">1</code>，那么图像是隔行生成的，<code class="language-plaintext highlighter-rouge">0</code>反之。图中这里为<code class="language-plaintext highlighter-rouge">0</code>，说明不是隔行生成。</li>
  <li>第 3 位是分类标志，用于表示颜色映射是否按照出现频率排列（或者其他因素）。不过只适用于 GIF89a。如果是 GIF87a，这部分始终为<code class="language-plaintext highlighter-rouge">0</code>。图中这里为<code class="language-plaintext highlighter-rouge">0</code>，说明没有排序颜色映射。</li>
  <li>第 3～4 位是保留位，始终为0。</li>
  <li>第 5～8 位是局部颜色映射条目的数量，用来表示局部颜色映射条目的数量。这里为<code class="language-plaintext highlighter-rouge">0</code>，说明此图像没有局部颜色映射。</li>
</ul>

<h3 id="局部颜色映射">局部颜色映射</h3>
<p>局部颜色映射和全局颜色映射是一样的。而且由上一节可知，这里没有局部颜色映射，所以没啥好说的了。</p>

<h3 id="光栅数据">光栅数据</h3>
<p>光栅数据（Raster data）就是图像数据（Image data）。
这部分数据由一块一块的数据构成。每一块由“块大小的计数字节”开始，值为 1～255（1h～ffh）。每一块的数据都使用 LZW（Lempel-Ziv-Welch）算法进行压缩。</p>

<p>还是以上面的例子说明一下，第一个图像的光栅数据是从<code class="language-plaintext highlighter-rouge">1b3h</code>的这个<code class="language-plaintext highlighter-rouge">ff</code>开始的，<code class="language-plaintext highlighter-rouge">ff</code>表示接下来的这块数据为 255 字节：</p>

<p><img src="/assets/images/7a3da15792f144e8b9356d91d4bdf3bb.png" alt="图中的 ff 表示接下来的这块数据为 255 字节" /></p>

<p>那么我们继续往下翻可以看到<code class="language-plaintext highlighter-rouge">2b3h</code>、<code class="language-plaintext highlighter-rouge">3b3h</code>、<code class="language-plaintext highlighter-rouge">4b3h</code>、<code class="language-plaintext highlighter-rouge">5b3h</code> 都是<code class="language-plaintext highlighter-rouge">ff</code>，也就是往后挪 256 位：</p>

<p><img src="/assets/images/461d3a18260d498cbf27e348dff52b10.png" alt="2b3h" />
<img src="/assets/images/bf592b796f7a416e8d3c9e30a04ca656.png" alt="3b3h" />
<img src="/assets/images/d6c1380062094079ac0ca5b0a93f4ea5.png" alt="4b3h" />
<img src="/assets/images/3eecaeb70889446abccb1fc83f00aadd.png" alt="5b3h" /></p>

<p>但是<code class="language-plaintext highlighter-rouge">6b3h</code>这个位置上是<code class="language-plaintext highlighter-rouge">c3</code>：</p>

<p><img src="/assets/images/6dd54b3ed6984768bcc27a98ab2b6ec6.png" alt="6b3h这个位置上是c3h" /></p>

<p>那么就往后挪 196（c3h + 1 = 195 + 1=196）位看看，也就是<code class="language-plaintext highlighter-rouge">777h</code>（6b0h + c3h + 1h）这个位置：</p>

<p><img src="/assets/images/44d252a4588d49c59911c1722ea5513a.png" alt="777h" /></p>

<p>可以看到这个位置为<code class="language-plaintext highlighter-rouge">00</code>，这表示当前图像块的光栅数据结束了（因为这里需要理解成下面的这块数据块有 0 个，然后就没有然后了）。</p>

<p>然后往后继续读取，在下一行<code class="language-plaintext highlighter-rouge">780h</code>的位置可以看到<code class="language-plaintext highlighter-rouge">2c</code>，表示新的图像描述符开始了。就这样循环往复，直到结束。</p>

<p>但是需要注意的是，不是每个块都是 255+255+…+xxx 这样美好的格式，有的是乱的，只要每个值在</p>

<h3 id="gif文件结尾">GIF文件结尾</h3>
<p>如果你了解一些底层的知识，会知道文件和数据可以没有开始符，但是需要结尾符。例如 C（或者 Python 这种 C 延伸出来的语言）的字符串都是以<code class="language-plaintext highlighter-rouge">\0</code>表示字符串结尾的。因为这样作为数据流在 UNIX 系统中就知道在哪里结束。那么 GIF 文件的结尾是什么呢？
GIF 的终止符是<code class="language-plaintext highlighter-rouge">;</code>，十六进制为<code class="language-plaintext highlighter-rouge">3b</code>。
<img src="/assets/images/e41d254e86ab4b7689805019bf339c8b.png" alt="GIF 的终止符是`;`，十六进制为`3b`。" /></p>

<p>可以看到终止符<code class="language-plaintext highlighter-rouge">3bh</code>前面有个<code class="language-plaintext highlighter-rouge">00h</code>，表示一个光栅数据的结尾。</p>

<h2 id="gif的静态图像长什么样">GIF的静态图像长什么样</h2>
<p>在 GIF 诞生的头几年，GIF 只有静态图像这一个用法。
下面这个图像是一个 GIF 文件（源自《Encyclopedia of Graphics File Formats, 2nd Edition》，是 2005 年的一本书），只有一个图像，分辨率为 1419 × 1001，你可以右键下载看看原图：</p>

<p><img src="/assets/images/0e51c3fe424242bb869777e3f2247029.GIF" alt="源自《Encyclopedia of Graphics File Formats, 2nd Edition》的静态GIF文件" /></p>

<h2 id="gif-的历史">GIF 的历史</h2>
<h3 id="诞生">诞生</h3>
<h4 id="背景知识">背景知识</h4>
<p>GIF 诞生在互联网出现之前。在互联网出现之前，有很多计算机厂商，这些厂商不像今天的厂商，只负责组装或者生产一部分硬件，当时大部分计算机厂商是要负责开发计算机的系统，甚至包括软件，例如现在大名鼎鼎的苹果就是当时众多计算机厂商中的一员。
不同的硬件、不同的目的导致设计出来的系统和应用也不是互相兼容的，当时买电脑会送一本书，这本书会告诉你如何在这台电脑上编程。比如下面的 Apple II 的说明书：</p>

<p><img src="/assets/images/20fa8f6d21e04522a1994071541d8ea9.jpeg" alt="Apple II 的说明书" /></p>

<h4 id="目的">目的</h4>
<p>当时CompuServe 的老板 Sandy Trevor 需要程序员为他解决两个主要问题：
首先，CompuServe 为需要访问电子邮件和传输文件的用户提供订阅（按小时计算），这需要一种可以在所有计算机上无缝显示的简单图形格式。也就是说，这个文件必须要通用。
其次，可能有些用电脑比较早的人还会记得，很早之前用拨号上网的时候，由于网速很慢，浏览网页会出现图片一点点往下刷新，如果网络出问题了，等了半天的图片就没了，需要刷新页面重新下载。所以这个文件必须要小。
最后，由于当时电脑内存太小了，所以不能占用太多的内存的同时，还要保持画面质量。</p>

<p>为了解决这个问题 CompuServe 就开发了 GIF。GIF 可以做到将数据流按照一块块地传输到客户端，然后逐步显示图片。或者隔行生成图像，那么就可以将图像隔行传输数据给客户端，这样虽然画面有损耗，但是可以脑补一下。比如说下面这样的图片隔行显示，看到下图中左边和中间的图像都可以大致脑补出图片内容，而逐行显示如果一点点从上到下显示是没办法脑补的。</p>

<p><img src="/assets/images/042f05e2224040a7801deadc39b6d061.jpeg" alt="逐行显示和隔行显示的区别" /></p>

<h3 id="替代品">替代品</h3>
<p>GIF 虽然是无损压缩的，但是单张图像的颜色最多只有 256 色。如果想实现颜色细腻的话可以使用拼接法，这样会导致文件过大，以及过于复杂。再者说就算费大劲解决了前面的问题（这个时候文件大小会非常恐怖），最高只能支持 24 位的 RGB 色彩空间也使得 GIF 的色彩是不会特别细腻的（现在的屏幕）。
其他方面，GIF 理论上最多可以显示约 43 亿像素的图片（这点可以看下面“GIF 文件格式”的内容），这点直到现在都不落伍。
但是 GIF 的尺寸和颜色一直是两大致命问题，所以就发明了 PNG 格式用来淘汰 GIF，甚至 PNG 的全称就是“PNG’s not GIF”，不过这是 1995 年之后的故事了，此时 GIF 已经诞生了快十年。
现在的我们可以看到，PNG 作为无损压缩图片很成功地在静态图像方面替代了 GIF，全方位优于 GIF（而且当时 GIF 由于使用 LZW 算法的原因是有专利限制的，而 PNG 是完全开源的）。但是 GIF 的动态图像却一直没有可替代者。
1999年的互联网上还有过一段全方位销毁 GIF 的活动，但是没有成功，现在也还有这样的行为，感兴趣可以看看<a href="https://burnallgifs.org/archives/">https://burnallgifs.org/archives/</a>。
没有成功是因为没有任何一个文件可以做到又容易实现、无声、又可以循环播放一个小动画。<strong>还有一个更重要的原因就是：GIF 是不需要任何解码器的就可以播放的。这样几乎所有的浏览器都可以播放 GIF 文件。</strong> 
2001 年虽然围绕着 PNG 诞生了 MNG（Multiple-image Network Graphics）多图像文件，并且功能和画质远好于 GIF，但是还是没有战胜 GIF（个人猜测是因为过于复杂了，MNG 甚至可以加上音轨，这种程度不如直接使用 MP4 等视频格式）。</p>

<h2 id="结论">结论</h2>
<p>GIF诞生之初是为了作为静态图片使用，就相当于今天的 PNG 和 JEPG。不过它的结构可以理解成一个简易版 PPT。pptx 文件是由 xml 和 图像文件组成的一个 tar 包，GIF 文件是由一些信息块、控制块和 LZW 压缩过后的光栅图像构成的，而且很巧合的是 Power Point 和 GIF 是同一年诞生的。但是可以通过控制显示 GIF 文件中每个光栅图像之间的间隔和动画，使得它可以呈现出动画/运动的效果（就像幻灯片可以做动画片，但是不能说幻灯片是视频一样）。</p>

<h2 id="大胆的推测">大胆的推测</h2>
<p>由于时间太过久远，我有一个想法无法得到验证。就是那个时候是不是有一股技术热潮，内容就是如何在计算机上做出幻灯片；于此同时 GIF 的开发者既想展现图片，又想有一些特殊的功能（不过更大的可能是公司要求）。
因为 GIF 可以响应用户操作这个功能就可以达到幻灯片的效果，而至今为止最出名的幻灯片软件 Power Point 也是同年诞生的，发布在苹果的 Macintosh 上。如果只是为了解决图片显示的问题，那么没有必要给 GIF 添加一些没必要的功能。
这里要考虑到当时还没有互联网，计算机科学这个学科也才诞生 20 多年，各种技术和应用还不成熟，个人计算机才刚刚推广开来。一些现在看来自然存在的技术和应用，是在当时多方竞争下存活的，比如 GIF，再比如 Linux 内核。所以我觉得这真的挺奇妙的：GIF 可能是根据要求加了一些额外的功能，但是碰巧是这些功能，让其没有被淘汰掉。 
话说是谁想到的 GIF 可以做动画呢？</p>

<p>希望本文能帮助到和我一样有疑惑的人哦～</p>

<h2 id="references">References</h2>
<p><a href="https://www.cs.cmu.edu/~cil/lzw.and.gif.txt">《LZW and GIF explained—-Steve Blackstock》</a></p>

<p><a href="https://www.fileformat.info/format/gif/egff.htm">《GIF File Format Summary》</a></p>

<p><a href="https://www.ntfs.com/gif-signature-format.htm">《GIF Signature Format: Introduction &amp; Recovery》</a></p>

<p><a href="https://www.bkacontent.com/the-history-of-the-gif-and-using-with-your-custom-writing-service/">《THE HISTORY OF GIFS AND HOW TO USE THEM》</a></p>


        </div>
    </body>
</html>